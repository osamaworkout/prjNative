<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>صفحة الطلبات</title>
    <link rel="stylesheet" href="../../Assets/Styles/orderList.css" />
  </head>
  <body>
    <!-- Header Buttons -->
    <div class="flex-between" style="margin-bottom: 16px; position: relative">
      <div style="display: flex; gap: 8px; order: 1">
        <button id="purchaseOrder" class="button secondary" onclick="">
          اذن الشراء
        </button>
        <button id="payOrder" class="button secondary" onclick="">
          اذن الصرف
        </button>
        <button id="maintananceOrder" class="button secondary" onclick="">
          اذن الصيانة
        </button>
        <button id="missionOrder" class="button secondary" onclick="">
          طلب مأمورية
        </button>
        <button id="jobOrder" class="button secondary">أوامر الشغل</button>
      </div>
      <div style="display: flex; gap: 8px; order: 2; position: relative">
        <button class="button" onclick="toggleFilterMenu()">
          &#128269; <span>فلتر</span>
        </button>
        <button class="button" onclick="refreshRequests()">
          &#x21bb; <span>تحديث</span>
        </button>
        <div id="filterMenu" class="dropdown hidden">
          <button onclick="showDateInput()">حسب التاريخ</button><br />
          <input
            type="date"
            id="filterDate"
            class="hidden"
            onchange="filterByExactDate(this.value)"
          />
          <button onclick="showStatusOptions()">حسب الحالة</button>
          <div id="statusOptions" class="hidden">
            <select onchange="filterByStatus(this.value)">
              <option value="">اختر الحالة</option>
              <option value="مقبول">مقبول</option>
              <option value="مرفوض">مرفوض</option>
              <option value="قيد الانتظار">قيد الانتظار</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Request List -->
    <div id="request-list" class="space-y-2"></div>

    <!-- Popup -->
    <div id="popup" class="popup hidden">
      <div class="popup-content">
        <h2 class="text-gray-600 text-sm">اسم الطلب</h2>
        <p id="popup-date"></p>
        <h3>رقم المسلسل</h3>
        <p id="popup-id"></p>
        <h4>اسم الشخص</h4>
        <div style="border-top: 1px solid #ccc; margin: 16px 0"></div>
        <div class="flex-between" style="text-align: right">
          <div>
            <p>القطعة: اسم القطعة</p>
            <p>الوصف: وصف القطعة</p>
            <p>الكمية: الكمية</p>
          </div>
          <div>
            <p>الحالة:</p>
            <span id="popup-status" class="badge"></span>
          </div>
        </div>
        <div class="flex-between" style="margin-top: 16px">
          <button class="button-accepted" onclick="closePopup()">موافقة</button>
          <button class="button-rejected" onclick="closePopup()">رفض</button>
        </div>
      </div>
    </div>
    <!-- Job Order Popup -->
    <div id="jobOrderPopup" class="popup hidden">
      <div
        class="popup-content"
        style="width: 90%; max-height: 80vh; overflow-y: auto"
      >
        <div class="flex-between">
          <h2>أوامر الشغل</h2>
          <button onclick="closeJobOrderPopup()">❌</button>
        </div>
        <div style="margin-bottom: 12px; text-align: left">
          <button class="button" onclick="openAddJobOrderForm()">
            ➕ إضافة أمر شغل
          </button>
        </div>
        <div id="jobOrdersContainer" class="space-y-2"></div>
      </div>
    </div>

    <!-- Add/Edit Job Order Form -->
    <div id="addJobOrderPopup" class="popup hidden">
      <div class="popup-content">
        <h2>أمر شغل جديد</h2>
        <form id="jobOrderForm" onsubmit="submitJobOrder(event)">
          <input
            type="text"
            placeholder="الوصف"
            id="description"
            required
          /><br />
          <input
            type="number"
            placeholder="رقم السيارة"
            id="vehicleId"
            required
          /><br />
          <input
            type="number"
            placeholder="رقم السائق"
            id="driverId"
            required
          /><br />
          <input
            type="datetime-local"
            placeholder="تاريخ البداية"
            id="startDate"
            required
          /><br />
          <input
            type="datetime-local"
            placeholder="تاريخ النهاية"
            id="endDate"
            required
          /><br />
          <input
            type="text"
            placeholder="الوجهة"
            id="destination"
            required
          /><br />
          <input
            type="number"
            placeholder="عداد قبل"
            id="odometerBefore"
            required
          /><br />
          <input
            type="number"
            placeholder="عداد بعد"
            id="odometerAfter"
            required
          /><br />
          <button class="button" type="submit">إرسال</button>
          <button
            class="button-rejected"
            type="button"
            onclick="closeAddJobOrderForm()"
          >
            إلغاء
          </button>
        </form>
      </div>
    </div>
    <script src="../../Java script/orderList.js"></script>
  </body>
</html>
